<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador NIF, CIF e IBAN</title>
    <link rel="icon" href="data:image/svg+xml,
        <svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 32 32%22><path d=%22M27 2H5C3.34315 2 2 3.34315 2 5V19C2 20.6569 3.34315 22 5 22H27C28.6569 22 30 20.6569 30 19V5C30 3.34315 28.6569 2 27 2Z%22 fill=%22%231565C0%22/><path d=%22M14.09 11.15C14.5183 10.734 14.8128 10.1997 14.9357 9.61538C15.0587 9.03108 15.0044 8.42339 14.78 7.8701C14.5555 7.3168 14.1711 6.84306 13.6758 6.50952C13.1806 6.17598 12.5971 5.9978 12 5.9978C11.4029 5.9978 10.8194 6.17598 10.3242 6.50952C9.82892 6.84306 9.44447 7.3168 9.22002 7.8701C8.99557 8.42339 8.94134 9.03108 9.06426 9.61538C9.18717 10.1997 9.48165 10.734 9.91 11.15C7.68 11.75 6 14.14 6 17C6 17.2652 6.10536 17.5196 6.29289 17.7071C6.48043 17.8946 6.73478 18 7 18C7.26522 18 7.51957 17.8946 7.70711 17.7071C7.89464 17.5196 8 17.2652 8 17C8 14.79 9.35 13 11 13H13C14.65 13 16 14.79 16 17C16 17.2652 16.1054 17.5196 16.2929 17.7071C16.4804 17.8946 16.7348 18 17 18C17.2652 18 17.5196 17.8946 17.7071 17.7071C17.8946 17.5196 18 17.2652 18 17C18 14.14 16.32 11.75 14.09 11.15ZM12 7.99999C12.1978 7.99999 12.3911 8.05864 12.5556 8.16852C12.72 8.2784 12.8482 8.43458 12.9239 8.6173C12.9996 8.80003 13.0194 9.0011 12.9808 9.19508C12.9422 9.38906 12.847 9.56724 12.7071 9.70709C12.5673 9.84695 12.3891 9.94219 12.1951 9.98077C12.0011 10.0194 11.8 9.99955 11.6173 9.92387C11.4346 9.84818 11.2784 9.72001 11.1685 9.55556C11.0586 9.39111 11 9.19777 11 8.99999C11 8.73477 11.1054 8.48042 11.2929 8.29288C11.4804 8.10534 11.7348 7.99999 12 7.99999Z%22 fill=%22%23E64A19%22/><path d=%22M25 8H22C21.7348 8 21.4804 7.89464 21.2929 7.70711C21.1054 7.51957 21 7.26522 21 7C21 6.73478 21.1054 6.48043 21.2929 6.29289C21.4804 6.10536 21.7348 6 22 6H25C25.2652 6 25.5196 6.10536 25.7071 6.29289C25.8946 6.48043 26 6.73478 26 7C26 7.26522 25.8946 7.51957 25.7071 7.70711C25.5196 7.89464 25.2652 8 25 8Z%22 fill=%22%23E0E0E0%22/><path d=%22M25 12H19C18.7348 12 18.4804 11.8946 18.2929 11.7071C18.1054 11.5196 18 11.2652 18 11C18 10.7348 18.1054 10.4804 18.2929 10.2929C18.4804 10.1054 18.7348 10 19 10H25C25.2652 10 25.5196 10.1054 25.7071 10.2929C25.8946 10.4804 26 10.7348 26 11C26 11.2652 25.8946 11.5196 25.7071 11.7071C25.5196 11.8946 25.2652 12 25 12Z%22 fill=%22%23E0E0E0%22/><path d=%22M25 16H22C21.7348 16 21.4804 15.8946 21.2929 15.7071C21.1054 15.5196 21 15.2652 21 15C21 14.7348 21.1054 14.4804 21.2929 14.2929C21.4804 14.1054 21.7348 14 22 14H25C25.2652 14 25.5196 14.1054 25.7071 14.2929C25.8946 14.4804 26 14.7348 26 15C26 15.2652 25.8946 15.5196 25.7071 15.7071C25.5196 15.8946 25.2652 16 25 16Z%22 fill=%22%23E0E0E0%22/><path d=%22M27 24H5C4.20435 24 3.44129 24.3161 2.87868 24.8787C2.31607 25.4413 2 26.2044 2 27C2 27.7956 2.31607 28.5587 2.87868 29.1213C3.44129 29.6839 4.20435 30 5 30H27C27.7956 30 28.5587 29.6839 29.1213 29.1213C29.6839 28.5587 30 27.7956 30 27C30 26.2044 29.6839 25.4413 29.1213 24.8787C28.5587 24.3161 27.7956 24 27 24Z%22 fill=%22%2337474F%22/><path d=%22M5 2C4.20435 2 3.44129 2.31607 2.87868 2.87868C2.31607 3.44129 2 4.20435 2 5V19C2 19.7956 2.31607 20.5587 2.87868 21.1213C3.44129 21.6839 4.20435 22 5 22H16V2H5Z%22 fill=%22%231E88E5%22/></svg>
    " type="image/svg+xml">
</head>
<style>
    html,
    body {
        font-family: Verdana, sans-serif;
        font-size: 15px;
        line-height: 1.5;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        font-family: "Segoe UI", Arial, sans-serif;
        font-weight: 400;
        margin: 10px 0;
    }

    ul {
        list-style-type: none;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: #333;
    }

    li {
        float: left;
    }

    li a {
        display: block;
        color: white;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        cursor: pointer;
    }

    li a:hover {
        background-color: #558123;
    }

    .active {
        background-color: #6AA02C;
    }

    input {
        background: #ffffff;
        padding: .25em;
        border: 1px solid rgba(0, 0, 0, 0.15);
        border-radius: 0.25em;
        font-size: 1em;
        line-height: 1.25;
        width: 100%;
        margin-top: 5px;
    }

    button {
        color: #ffffff;
        background-color: #6AA02C;
        border: 1px solid transparent;
        padding: .25em 1em;
        font-size: 1em;
        display: inline-flex;
        border-radius: 0.25em;
        transition: background-color 0.3s;
        display: inline-block;
        position: relative;
        text-decoration: none !important;
        cursor: pointer;
        text-align: center;
        overflow: visible;
    }

    button:hover {
        background-color: #82be3c;
    }

    button:active {
        background-color: #558123;
    }

    .input-container {
        position: relative;
        display: inline-block;
    }

    .input-container::after {
        content: "¡Copiado!";
        position: absolute;
        top: 35px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #333;
        color: #fff;
        padding: 5px;
        border-radius: 5px;
        white-space: nowrap;
        font-size: 12px;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
    }

    .input-container.show-tooltip::after {
        opacity: 1;
    }
</style>

<body>
    <script type="application/javascript">
        function formatNumberLength(num, length) {
            var r = "" + num;
            while (r.length < length) {
                r = "0" + r;
            }
            return r;
        }

        function charDNI(dni) {
            var chain = "TRWAGMYFPDXBNJZSQVHLCKET";
            var pos = dni % 23;
            var letter = chain.substring(pos, pos + 1);
            return letter;
        }

        function rand_dni() {
            num = Math.floor((Math.random() * 100000000));
            sNum = formatNumberLength(num, 8);
            return sNum + charDNI(sNum);
        }

        function generarCIF() {
            const letras = "ABCDEFGHJKLMNPQRSUVW";
            const letra = letras[Math.floor(Math.random() * letras.length)];
            let numeros = "";
            for (let i = 0; i < 7; i++) numeros += Math.floor(Math.random() * 10);
            const cif = letra + numeros;

            let sumaPar = 0, sumaImpar = 0;
            for (let i = 1; i < cif.length; i++) {
                const num = parseInt(cif[i], 10);
                if (i % 2 === 0) sumaPar += num;
                else {
                    const doble = num * 2;
                    sumaImpar += doble > 9 ? doble - 9 : doble;
                }
            }

            const sumaTotal = sumaPar + sumaImpar;
            const digitoControl = (10 - (sumaTotal % 10)) % 10;
            const letrasControl = "JABCDEFGHI";

            const control = "PQRS".includes(letra) ? letrasControl[digitoControl] :
                "ABEH".includes(letra) ? digitoControl :
                    Math.random() < 0.5 ? digitoControl : letrasControl[digitoControl];

            return cif + control;
        }

        function myFunction() {
            var copyText = document.getElementById("txtNIF");
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(copyText.value);
        }

        function cp2clipboard(a) {
            if (a.value) {
                navigator.clipboard.writeText(a.value);
                a.parentNode.classList.add("show-tooltip");
                setTimeout(() => {
                    a.parentNode.classList.remove("show-tooltip");
                }, 2000);
            }
        }

        function generarIBAN() {
            const pais = "ES"; // Código de país (España)
            const banco = generarNumeroAleatorio(4); // Código del banco
            const sucursal = generarNumeroAleatorio(4); // Código de la sucursal
            const cuenta = generarNumeroAleatorio(10); // Número de cuenta

            // Calcular DC1 y DC2
            const dc1 = obtenerDigito("00" + banco + sucursal);
            const dc2 = obtenerDigito(cuenta);

            // Generar IBAN final con cálculos correctos
            const ibanFinal = calcularIBAN(pais, banco, sucursal, dc1, dc2, cuenta);

            return ibanFinal;
        }

        function calcularIBAN(pais, banco, sucursal, dc1, dc2, cuenta) {
            const letras = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            const prefijoNumerico = String(
                letras.indexOf(pais[0]) + 10
            ) + String(letras.indexOf(pais[1]) + 10);

            const ibanSinDC = banco + sucursal + dc1 + dc2 + cuenta;
            const ibanNumerico = ibanSinDC + prefijoNumerico + "00";

            // Calcular los dígitos de control del IBAN (XX)
            const resto = modulo97(ibanNumerico);
            const digitosControl = String(98 - resto).padStart(2, "0");

            return pais + digitosControl + ibanSinDC;
        }

        function generarNumeroAleatorio(digitos) {
            return String(Math.floor(Math.random() * Math.pow(10, digitos))).padStart(digitos, "0");
        }

        function obtenerDigito(valor) {
            const valores = [1, 2, 4, 8, 5, 10, 9, 7, 3, 6];
            let control = 0;

            for (let i = 0; i < 10; i++) {
                control += Number(valor.charAt(i)) * valores[i];
            }

            control = 11 - (control % 11);
            if (control === 11) {
                control = 0;
            } else if (control === 10) {
                control = 1;
            }
            return control;
        }

        function modulo97(numero) {
            let resto = numero;
            while (resto.length > 2) {
                const fragmento = resto.slice(0, 9);
                resto = (parseInt(fragmento, 10) % 97).toString() + resto.slice(9);
            }
            return parseInt(resto, 10) % 97;
        }

        function toggleLi(li) {
            for (var generador of document.getElementById("generadores").children) {
                generador.style.display = 'none';
            }
            document.getElementById("gen" + li).style.display = 'block';
            document.getElementById('menu').querySelectorAll('li').forEach(li => li.classList.remove('active'))
            document.getElementById("btn" + li).parentNode.classList.add('active');
        }

    </script>
    <ul id="menu">
        <li class="active"><a id="btnNIF" onclick="toggleLi('NIF');">Generador NIF</a></li>
        <li><a id="btnCIF" onclick="toggleLi('CIF');">Generador CIF</a></li>
        <li><a id="btnIBAN" onclick="toggleLi('IBAN');">Generador IBAN</a></li>
    </ul>
    <div id="generadores" style="padding-left: 16px;">
        <div id="genNIF" style="display: block;">
            <h3>Generador NIF</h3>
            <div class="input-container">
                <input type="text" id="txtNIF" style="width:6em;text-align:center;" onclick="cp2clipboard(this);"
                    readonly>
            </div>
            <button id="btnGenNif" onclick="document.getElementById('txtNIF').value = rand_dni();">Generar</button>
        </div>
        <div id="genCIF" style="display: none;">
            <h3>Generador CIF</h3>
            <div class="input-container">
                <input type="text" id="txtCIF" readonly style="width:6em;text-align:center;"
                    onclick="cp2clipboard(this);">
            </div>
            <button id="btnGenCif" onclick="document.getElementById('txtCIF').value = generarCIF();">Generar</button>
        </div>
        <div id="genIBAN" style="display: none;">
            <h3>Generador IBAN</h3>
            <div class="input-container">
                <input type="text" id="txtIBAN" readonly style="width:14.5em;text-align:center;"
                    onclick="cp2clipboard(this);">
            </div>
            <button id="btnGenCif" onclick="document.getElementById('txtIBAN').value = generarIBAN();">Generar</button>
        </div>
    </div>

</body>

</html>